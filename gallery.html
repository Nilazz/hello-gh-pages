<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Galeria</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root{
      --bg:#f6f8fb; --surface:#ffffff; --text:#0f1724; --muted:#6b7280;
      --accent:#1e88ff; --radius:12px; --shadow:0 8px 30px rgba(2,6,23,0.08);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    [data-theme="dark"]{
      --bg:#071025; --surface:#0f1724; --text:#e6eef8; --muted:#9aa7bb;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
    header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px}
    header a{color:var(--text);text-decoration:none;font-weight:600;display:inline-flex;gap:8px;align-items:center}
    .wrap{max-width:1100px;margin:0 auto;padding:12px 20px 48px;box-sizing:border-box}
    h1{margin:6px 0 12px;font-size:22px}
    p.lead{margin:0 0 18px;color:var(--muted)}

    .grid{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:14px;
    }
    .card{
      background:var(--surface);
      border-radius:10px;
      overflow:hidden;
      box-shadow:var(--shadow);
      display:block;
      position:relative;
      cursor:zoom-in;
    }
    .card img{width:100%;height:200px;object-fit:cover;display:block;transition:transform .18s}
    .card:hover img{transform:scale(1.03)}
    .caption{
      position:absolute;left:10px;right:10px;bottom:10px;padding:6px 8px;border-radius:8px;background:linear-gradient(180deg,rgba(0,0,0,0.15),rgba(0,0,0,0.3));
      color:white;font-size:13px;backdrop-filter: blur(4px);
    }

    /* responsive */
    @media (max-width:980px){ .grid{grid-template-columns:repeat(3,1fr)} }
    @media (max-width:680px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:420px){ .grid{grid-template-columns:1fr} .card img{height:160px} }

    /* lightbox */
    .lb-backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);z-index:120;padding:18px}
    .lb-backdrop.open{display:flex}
    .lb{
      width:100%;max-width:1100px;border-radius:12px;overflow:hidden;background:#000;box-shadow:0 20px 60px rgba(0,0,0,0.6);
      display:flex;flex-direction:column;align-items:center;
    }
    .lb img{width:100%;height:auto;display:block;max-height:80vh;object-fit:contain;background:#000}
    .lb .meta{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:linear-gradient(180deg,rgba(0,0,0,0.4),rgba(0,0,0,0.2));color:#fff}
    .lb .meta .title{font-weight:700}
    .lb .controls{display:flex;gap:8px}
    .btn{background:rgba(255,255,255,0.08);border:none;padding:8px 10px;border-radius:8px;color:#fff;cursor:pointer}
    .btn:active{transform:translateY(1px)}
  </style>
</head>
<body>
  <header>
    <a href="index.html" aria-label="Wr√≥ƒá do strony g≈Ç√≥wnej">‚Üê Powr√≥t</a>
    <div style="display:flex;gap:10px;align-items:center">
      <button id="themeToggle" aria-label="Prze≈ÇƒÖcz tryb" title="Prze≈ÇƒÖcz tryb" style="height:44px;width:44px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:var(--surface)"></button>
    </div>
  </header>

  <div class="wrap">
    <h1>Galeria</h1>
    <p class="lead">Przyk≈Çadowa galeria zdjƒôƒá z lekkim lightboxem. Kliknij miniaturƒô, aby powiƒôkszyƒá ‚Äî obs≈Çuga klawiatury: ‚Üê ‚Üí Esc.</p>

    <div class="grid" id="gallery">
      <!-- obrazki: u≈ºywamy tylko nazwy pliku ‚Äî ≈õcie≈ºkƒô wybierzemy dynamicznie (resolver sprawdzi Images/ i images/) -->
      <a class="card" href="#" data-filename="1.png" data-title="Zdjƒôcie 1">
        <img src="" alt="Zdjƒôcie 1">
        <div class="caption">Zdjƒôcie 1</div>
      </a>
      <a class="card" href="#" data-filename="2.png" data-title="Zdjƒôcie 2">
        <img src="" alt="Zdjƒôcie 2">
        <div class="caption">Zdjƒôcie 2</div>
      </a>
      <a class="card" href="#" data-filename="3.png" data-title="Zdjƒôcie 3">
        <img src="" alt="Zdjƒôcie 3">
        <div class="caption">Zdjƒôcie 3</div>
      </a>
      <a class="card" href="#" data-filename="4.png" data-title="Zdjƒôcie 4">
        <img src="" alt="Zdjƒôcie 4">
        <div class="caption">Zdjƒôcie 4</div>
      </a>
      <a class="card" href="#" data-filename="5.png" data-title="Memesek">
        <img src="" alt="Memesek">
        <div class="caption">Memesek</div>
      </a>
    </div>
  </div>

  <!-- lightbox -->
  <div id="lb" class="lb-backdrop" role="dialog" aria-hidden="true" aria-label="PodglƒÖd obrazu">
    <div class="lb" role="document">
      <img id="lbImg" src="" alt="">
      <div class="meta">
        <div class="title" id="lbTitle"></div>
        <div class="controls">
          <button id="prev" class="btn" title="Poprzednie">‚Üê</button>
          <button id="next" class="btn" title="Nastƒôpne">‚Üí</button>
          <button id="close" class="btn" title="Zamknij">‚úï</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // theme toggle: reuse key 'theme-preference' so pages stay in sync
    (function(){
      const btn = document.getElementById('themeToggle');
      const root = document.documentElement;
      const key = 'theme-preference';
      const sun = '‚òÄ';
      const moon = 'üåô';
      function apply(t){
        if(t==='dark'){ root.setAttribute('data-theme','dark'); btn.textContent = moon; }
        else{ root.removeAttribute('data-theme'); btn.textContent = sun; }
      }
      const saved = localStorage.getItem(key) || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      apply(saved);
      btn.addEventListener('click', ()=> {
        const cur = root.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
        const next = cur === 'dark' ? 'light' : 'dark';
        apply(next); localStorage.setItem(key, next);
      });
    })();

    // resolve image folder (try several common prefixes) and set src/data-src for gallery items
    (function(){
      const prefixes = ['Images/','images/','./Images/','./images/','/Images/','/images/'];
      const cards = Array.from(document.querySelectorAll('#gallery .card'));
      function testImage(url){
        return new Promise(resolve => {
          const img = new Image();
          img.onload = () => resolve(true);
          img.onerror = () => resolve(false);
          img.src = url + '?_=' + Date.now();
        });
      }
      async function resolvePrefixes(){
        if(!cards.length) return;
        for(const p of prefixes){
          const firstName = cards[0].dataset.filename;
          if(!firstName) break;
          const ok = await testImage(p + firstName);
          if(ok){
            cards.forEach(c => {
              const name = c.dataset.filename;
              const url = p + name;
              c.dataset.src = url;
              const img = c.querySelector('img');
              if(img) img.src = url;
            });
            return;
          }
        }
        console.warn('Nie znaleziono obraz√≥w w prefiksach:', prefixes);
      }
      resolvePrefixes();
    })();

    // gallery + lightbox
    (function(){
      // items: dataset.src should be set by resolver above
      const items = Array.from(document.querySelectorAll('#gallery .card'));
      const lb = document.getElementById('lb');
      const lbImg = document.getElementById('lbImg');
      const lbTitle = document.getElementById('lbTitle');
      const prev = document.getElementById('prev');
      const next = document.getElementById('next');
      const close = document.getElementById('close');
      let index = -1;
 
      function open(i){
        const it = items[i];
        if(!it) return;
        index = i;
        // prefer resolved data-src, fall back to filename if needed
        lbImg.src = it.dataset.src || it.dataset.filename || '';
        lbImg.alt = it.querySelector('img').alt || '';
        lbTitle.textContent = it.dataset.title || '';
        lb.classList.add('open');
        lb.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
       }
      function closeLB(){
        lb.classList.remove('open');
        lb.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
        lbImg.src = '';
      }
      function showPrev(){ if(index > 0) open(index - 1); }
      function showNext(){ if(index < items.length - 1) open(index + 1); }

      items.forEach((a,i) => {
        a.addEventListener('click', e => { e.preventDefault(); open(i); });
      });
      prev.addEventListener('click', showPrev);
      next.addEventListener('click', showNext);
      close.addEventListener('click', closeLB);
      lb.addEventListener('click', e => { if(e.target === lb) closeLB(); });

      document.addEventListener('keydown', e => {
        if(!lb.classList.contains('open')) return;
        if(e.key === 'Escape') closeLB();
        if(e.key === 'ArrowLeft') showPrev();
        if(e.key === 'ArrowRight') showNext();
      });
    })();
  </script>
</body>
</html>